<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Manage Komplexität - Ein interaktives Story-Erlebnis">
    <meta name="color-scheme" content="light dark">
    <meta name="theme-color" content="#F0F5F9">
    <title>TestStory - storyde</title>

    <script>
      (function() {
        var savedTheme = localStorage.getItem('game-theme');
        var systemPrefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        var theme = savedTheme || (systemPrefersDark ? 'dark' : 'light');
        var root = document.documentElement;
        root.classList.remove('theme-light', 'theme-dark');
        root.classList.add(theme === 'dark' ? 'theme-dark' : 'theme-light');
        var meta = document.querySelector('meta[name="theme-color"]');
        if (meta) {
          meta.setAttribute('content', theme === 'dark' ? '#0A1419' : '#F0F5F9');
        }
      }());
    </script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700&family=Quicksand:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" type="text/css" href="game.css">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
      /* Make Lucide icons thinner */
      [data-lucide] {
        stroke-width: 1.5 !important;
      }
    </style>
    
    <!-- jQuery and Dendry -->
    <script src="jquery-1.11.1.min.js"></script>
    <script src="core.js"></script>
    <script src="game.js"></script>
  </head>
  <body class="theme-light">
    <div class="app-bg" aria-hidden="true"></div>
    
    <!-- Main Container -->
    <div class="main-container">
      
      <!-- Top Header with Toggle Buttons -->
      <header class="top-header">
        <div class="header-content">
          <button id="progress-toggle" class="header-btn" aria-label="Fortschritt umschalten" title="Fortschrittsbereich umschalten">
            <i data-lucide="map"></i>
          </button>
          
          <div class="game-title">
            <h1>Manage Komplexität</h1>
          </div>
          
          <button id="info-toggle" class="header-btn" aria-label="Info umschalten" title="Info-Bereich umschalten">
            <i data-lucide="info"></i>
          </button>
        </div>
      </header>

      <!-- Content Wrapper -->
      <div class="content-wrapper">
        
        <!-- Left Sidebar - Progress -->
        <aside id="progress-sidebar" class="sidebar sidebar-left">
          <div class="sidebar-header">
            <h3>
              <i data-lucide="map"></i>
              Fortschritt
            </h3>
          </div>
          <div class="sidebar-content">
            <div id="progress" role="region" aria-label="Informationen zum Spielfortschritt">
              <!-- Dendry progress content will be populated here -->
            </div>
          </div>
        </aside>

        <!-- Chat Area -->
        <main class="chat-main">
          <div id="chat-container" class="chat-container" role="log" aria-label="Spielverlauf">
            <div id="content" class="chat-messages" aria-live="polite">
              <!-- Dendry game content will be displayed here -->
            </div>
          </div>

          <!-- Choices Container -->
          <div id="choices-container" class="choices-container" style="display: none;" role="region" aria-label="Verfügbare Entscheidungen">
            <!-- Dendry choices will be populated here -->
          </div>

          <!-- Bottom Spacer -->
          <div class="bottom-spacer"></div>
        </main>

        <!-- Right Sidebar - Info -->
        <aside id="info-sidebar" class="sidebar sidebar-right">
          <div class="sidebar-header">
            <h3>
              <i data-lucide="info"></i>
              Info
            </h3>
            <div class="sidebar-header-actions">
              <button id="theme-toggle" class="sidebar-header-btn" aria-label="Design umschalten" tabindex="0">
                <i data-lucide="moon"></i>
              </button>
              <button class="sidebar-header-btn" onclick="window.showSaveSlots();" aria-label="Spiel speichern/laden" tabindex="0">
                <i data-lucide="save"></i>
              </button>
            </div>
          </div>
          <div class="sidebar-content">
            <div id="info" role="region" aria-label="Spielinformationen">
              <!-- Dendry info content will be populated here -->
            </div>
          </div>
        </aside>

      </div>

      <!-- Sidebar Overlay for Mobile -->
      <div id="sidebar-overlay" class="sidebar-overlay"></div>

    </div>

    <!-- Save/Load Modal -->
    <div id="save" class="modal-overlay" style="display: none;" role="dialog" aria-labelledby="save-modal-title" aria-modal="true">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="save-modal-title">Spiel speichern &amp; laden</h2>
          <button onclick="window.hideSaveSlots();" class="modal-close" aria-label="Speicherdialog schließen">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <table id="saves_table" class="saves-table" role="table" aria-label="Speicherstände">
            <thead>
              <tr>
                <th scope="col">Slot</th>
                <th scope="col">Aktion</th>
                <th scope="col">Löschen</th>
                <th scope="col">Speicherinfo</th>
              </tr>
            </thead>
            <tbody>
            <tr>
                <th scope="row">Auto-0</th>
                <td><button class="save-button" id="save_button_a0">Speichern</button></td>
                <td><button class="delete-button" id="delete_button_a0">Löschen</button></td>
                <td class="save_info" id="save_info_a0"></td>
            </tr>
            <tr>
                <th scope="row">Auto-1</th>
                <td><button class="save-button" id="save_button_a1">Speichern</button></td>
                <td><button class="delete-button" id="delete_button_a1">Löschen</button></td>
                <td class="save_info" id="save_info_a1"></td>
            </tr>
            <tr>
                <th scope="row">0</th>
                <td><button class="save-button" id="save_button_0">Speichern</button></td>
                <td><button class="delete-button" id="delete_button_0">Löschen</button></td>
                <td class="save_info" id="save_info_0"></td>
            </tr>
            <tr>
                <th scope="row">1</th>
                <td><button class="save-button" id="save_button_1">Speichern</button></td>
                <td><button class="delete-button" id="delete_button_1">Löschen</button></td>
                <td class="save_info" id="save_info_1"></td>
            </tr>
            <tr>
                <th scope="row">2</th>
                <td><button class="save-button" id="save_button_2">Speichern</button></td>
                <td><button class="delete-button" id="delete_button_2">Löschen</button></td>
                <td class="save_info" id="save_info_2"></td>
            </tr>
            <tr>
                <th scope="row">3</th>
                <td><button class="save-button" id="save_button_3">Speichern</button></td>
                <td><button class="delete-button" id="delete_button_3">Löschen</button></td>
                <td class="save_info" id="save_info_3"></td>
            </tr>
            <tr>
                <th scope="row">4</th>
                <td><button class="save-button" id="save_button_4">Speichern</button></td>
                <td><button class="delete-button" id="delete_button_4">Löschen</button></td>
                <td class="save_info" id="save_info_4"></td>
            </tr>
            <tr>
                <th scope="row">5</th>
                <td><button class="save-button" id="save_button_5">Speichern</button></td>
                <td><button class="delete-button" id="delete_button_5">Löschen</button></td>
                <td class="save_info" id="save_info_5"></td>
            </tr>
            <tr>
                <th scope="row">6</th>
                <td><button class="save-button" id="save_button_6">Speichern</button></td>
                <td><button class="delete-button" id="delete_button_6">Löschen</button></td>
                <td class="save_info" id="save_info_6"></td>
            </tr>
            <tr>
                <th scope="row">7</th>
                <td><button class="save-button" id="save_button_7">Speichern</button></td>
                <td><button class="delete-button" id="delete_button_7">Löschen</button></td>
                <td class="save_info" id="save_info_7"></td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script>
      // Initialize Lucide icons after DOM is loaded
      document.addEventListener('DOMContentLoaded', function() {
        lucide.createIcons();
      });
    </script>
  </body>
</html>
